import{j as e,r as d,u as v,i as A,s as B,h as M,x as R}from"./app-BX_MbBCE.js";import{s as q}from"./grade-thunk-Bv6v6ZnV.js";import{F as S,I as T,S as C}from"./Select-DzTLNo_5.js";import{M as t}from"./MenuItem-Dtq7Z6oQ.js";import{F as E,T as w}from"./TextField-BVbxHzzk.js";import{T as H,a as N,b as k,c as _,d as m,e as Q}from"./TableRow-CrYq6UaL.js";import{P as V}from"./Paper-CQnIlVcQ.js";import{B as W}from"./Modal-Dl5T9eBG.js";import{c as G}from"./createSvgIcon-DsSdJk3K.js";import"./DefaultPropsProvider-DNQyY7TH.js";import"./InputBase-URC8wes5.js";import"./isHostComponent-DVu5iVWx.js";import"./index-B-G9468S.js";import"./useTheme-CLuwMYhu.js";import"./ButtonBase-HlmoPRVP.js";import"./extendSxProp-DDxhhc19.js";import"./ownerWindow-6z4QwRpV.js";import"./debounce-Be36O1Ab.js";import"./Popover-DAEiIx5l.js";import"./useSlot-CLbpkNHK.js";import"./resolveComponentProps-Ctxa67Yh.js";import"./Grow-D-nJzyoj.js";import"./utils-Bu-v38X3.js";import"./createSimplePaletteValueFilter-bm0fmN_7.js";import"./react-is.production.min-DUDD-a5e.js";import"./index-QseRsG1u.js";import"./useSlotProps-D7iM8rD8.js";import"./useControlled-CQesw5Ne.js";import"./useId-C3Six0EZ.js";import"./listItemTextClasses-B38WeSal.js";const D=G(e.jsx("path",{d:"M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3m3-10H5V5h10z"}),"Save");function Te(){const[x,f]=d.useState([]),[a,j]=d.useState({}),[b,u]=d.useState(!1),[i,g]=d.useState({}),{students:l,search:z}=v(s=>s.instructors),{user:F}=v(s=>s.app),I=A();d.useEffect(()=>{if(l.length>0){const s=l.map(r=>({...r,user_id:r.user.user_id,score:""}));f(s)}},[l.length]);const P=(s,r,o)=>{const p=s.target.value;f(c=>{const h=c.findIndex(n=>n.user_id===r);if(h!==-1){const n=[...c];return n[h].score=p,n}else return[...c,{user_id:r,user:o,score:p}]}),p!==""&&g(c=>{const{[r]:h,...n}=c;return n})},L=()=>{let s=!0,r={};return a.lecture||(r.lecture="Lecture is required",s=!1),a.assessment||(r.assessment="Assessment is required",s=!1),x.forEach(o=>{o.score===""&&(r[o.user_id]="Score is required",s=!1)}),g(r),s},y=async()=>{if(L()){u(!0);try{const s=await B.dispatch(q({...a,user_id:F.user_id,search:z,records:x,date:M().format("LL")}));I(R([])),u(!1)}catch(s){console.error("Submission error:",s),u(!1)}}};return e.jsxs("div",{className:"flex flex-col gap-5",children:[l.length!==0&&e.jsxs("div",{className:"flex gap-5",children:[e.jsxs(S,{fullWidth:!0,error:!!i.lecture,children:[e.jsx(T,{id:"demo-simple-select-label",children:"Lecture"}),e.jsxs(C,{labelId:"demo-simple-select-label",id:"demo-simple-select",name:"lecture",label:"Lecture",onChange:s=>j({...a,[s.target.name]:s.target.value}),value:a.lecture??"",children:[e.jsx(t,{value:"Examination",children:"Examination (30%)"}),e.jsx(t,{value:"Quizzes",children:"Quizzes (30%)"}),e.jsx(t,{value:"Projects/Assignment",children:"Projects/Assignment (20%)"}),e.jsx(t,{value:"Class Participation",children:"Class Participation (20%)"})]}),e.jsx(E,{children:i.lecture??""})]}),e.jsxs(S,{fullWidth:!0,error:!!i.assessment,children:[e.jsx(T,{id:"demo-simple-select-label",children:"Assessment"}),e.jsxs(C,{labelId:"demo-simple-select-label",id:"demo-simple-select",name:"assessment",label:"Assessment",onChange:s=>j({...a,[s.target.name]:s.target.value}),children:[e.jsx(t,{value:"Prelim",children:"Prelim"}),e.jsx(t,{value:"Midterm",children:"Midterm"}),e.jsx(t,{value:"Final",children:"Final"})]}),e.jsx(E,{children:i.assessment??""})]})]}),e.jsx(H,{component:V,children:e.jsxs(N,{sx:{minWidth:650},"aria-label":"a dense table",children:[e.jsx(k,{children:e.jsxs(_,{children:[e.jsx(m,{children:"Students"}),e.jsx(m,{children:"Grades"})]})}),e.jsx(Q,{children:l.map((s,r)=>e.jsxs(_,{sx:{"&:last-child td, &:last-child th":{border:0}},children:[e.jsxs(m,{component:"th",scope:"row",children:[s.user.fname," ",s.user.lname]}),e.jsx(m,{children:e.jsx(w,{onChange:o=>P(o,s.user.user_id,s.user),label:"Score",variant:"outlined",error:!!i[s.user.user_id],helperText:i[s.user.user_id]??""})})]},r))})]})}),l.length!==0&&e.jsx("div",{className:"flex w-full items-end justify-end",children:e.jsxs(W,{onClick:y,variant:"contained",className:"flex gap-2",disabled:b,children:[e.jsx(D,{}),e.jsx("div",{children:b?"Submitting...":"Add Records"})]})})]})}export{Te as default};
